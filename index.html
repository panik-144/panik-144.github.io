<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>File Browser</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color: #0f0f11;
      --card-bg: #18181b;
      --hover-bg: #27272a;
      --text-primary: #f4f4f5;
      --text-secondary: #a1a1aa;
      --accent: #6366f1;
      --accent-hover: #818cf8;
      --border: #27272a;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-primary);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .container {
      width: 100%;
      max-width: 900px;
      padding: 40px 20px;
    }

    header {
      margin-bottom: 40px;
      text-align: center;
      animation: fadeInDown 0.6s ease-out;
    }

    h1 {
      font-weight: 600;
      font-size: 2rem;
      margin: 0 0 10px 0;
      background: linear-gradient(to right, #fff, #a1a1aa);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .breadcrumbs {
      display: flex;
      gap: 8px;
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .breadcrumb-item {
      cursor: pointer;
      transition: color 0.2s;
    }

    .breadcrumb-item:hover {
      color: var(--text-primary);
      text-decoration: underline;
    }

    .breadcrumb-separator {
      opacity: 0.5;
    }

    #file-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      width: 100%;
    }

    .item {
      display: flex;
      align-items: center;
      padding: 16px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      text-decoration: none;
      color: var(--text-primary);
      transition: all 0.2s ease;
      cursor: pointer;
      animation: fadeIn 0.3s ease-out forwards;
      opacity: 0;
    }

    .item:hover {
      background: var(--hover-bg);
      transform: translateY(-2px);
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .icon {
      width: 24px;
      height: 24px;
      margin-right: 16px;
      flex-shrink: 0;
      fill: var(--text-secondary);
    }

    .item:hover .icon {
      fill: var(--accent);
    }

    .name {
      flex-grow: 1;
      font-weight: 500;
    }

    .meta {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    .loading {
      text-align: center;
      color: var(--text-secondary);
      margin-top: 40px;
    }

    .error {
      color: #ef4444;
      text-align: center;
      padding: 20px;
      background: rgba(239, 68, 68, 0.1);
      border-radius: 8px;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body>

  <div class="container">
    <header>
      <h1>Repository Browser</h1>
      <div style="color: var(--text-secondary); font-size: 0.9rem;">panik-144.github.io</div>
    </header>

    <div class="breadcrumbs" id="breadcrumbs"></div>
    <div id="file-list"></div>
  </div>

  <script>
    const REPO = "panik-144/panik-144.github.io";
    const BRANCH = "main"; // or master, depending on your default

    // Icons
    const ICONS = {
      folder: '<svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg>',
      file: '<svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>',
      back: '<svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>'
    };

    const listEl = document.getElementById("file-list");
    const breadcrumbsEl = document.getElementById("breadcrumbs");

    async function fetchFiles(path) {
      listEl.innerHTML = '<div class="loading">Loading...</div>';

      try {
        // Clean path
        const cleanPath = path.replace(/^\//, "").replace(/\/$/, "");
        const apiUrl = `https://api.github.com/repos/${REPO}/contents/${cleanPath}`;

        const res = await fetch(apiUrl);
        if (!res.ok) throw new Error(`GitHub API Error: ${res.status}`);
        const data = await res.json();

        renderList(data, cleanPath);
        renderBreadcrumbs(cleanPath);
      } catch (err) {
        console.error(err);
        listEl.innerHTML = `<div class="error">Failed to load content.<br>${err.message}</div>`;
      }
    }

    function renderList(files, currentPath) {
      listEl.innerHTML = "";

      // Sort: Folders first, then files
      files.sort((a, b) => {
        if (a.type === b.type) return a.name.localeCompare(b.name);
        return a.type === "dir" ? -1 : 1;
      });

      // Add ".." if not root
      if (currentPath) {
        const parentPath = currentPath.split("/").slice(0, -1).join("/");
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `<div class="icon">${ICONS.back}</div><div class="name">..</div>`;
        div.onclick = () => location.hash = parentPath ? `#/${parentPath}` : "#/";
        listEl.appendChild(div);
      }

      files.forEach((f, index) => {
        if (f.name === "index.html") return; // Hide the index itself

        const div = document.createElement("a");
        div.className = "item";
        div.style.animationDelay = `${index * 0.05}s`;

        if (f.type === "dir") {
          div.href = `#/${f.path}`;
          div.innerHTML = `<div class="icon">${ICONS.folder}</div><div class="name">${f.name}</div>`;
        } else {
          div.href = f.download_url; // Direct download/view
          div.target = "_blank";
          div.innerHTML = `<div class="icon">${ICONS.file}</div><div class="name">${f.name}</div><div class="meta">${formatSize(f.size)}</div>`;
        }

        listEl.appendChild(div);
      });
    }

    function renderBreadcrumbs(path) {
      const parts = path.split("/").filter(p => p);
      let html = `<span class="breadcrumb-item" onclick="location.hash='#/'">root</span>`;

      let current = "";
      parts.forEach(part => {
        current += `/${part}`;
        html += ` <span class="breadcrumb-separator">/</span> <span class="breadcrumb-item" onclick="location.hash='#${current}'">${part}</span>`;
      });

      breadcrumbsEl.innerHTML = html;
    }

    function formatSize(bytes) {
      if (bytes === 0) return "0 B";
      const k = 1024;
      const sizes = ["B", "KB", "MB", "GB"];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + " " + sizes[i];
    }

    // Handle Navigation
    function handleHashChange() {
      const hash = location.hash.slice(1) || "/"; // Remove #
      fetchFiles(hash);
    }

    window.addEventListener("hashchange", handleHashChange);

    // Initial Load
    handleHashChange();

  </script>
</body>

</html>