<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Repo File Tree</title>
<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
    }
    .dir {
        color: #0A58CA; /* Blau */
        cursor: pointer;
        font-weight: bold;
        margin-left: 10px;
    }
    .file {
        margin-left: 25px;
    }
    .nested {
        margin-left: 20px;
        display: none;
    }
</style>
</head>
<body>

<h1>Dateien im Repository</h1>
<div id="tree"></div>

<script>
const USER = "panik-144";
const REPO = "panik-144.github.io";
const BRANCH = "main";

async function fetchDir(path = "") {
    const url = `https://api.github.com/repos/${USER}/${REPO}/contents/${path}?ref=${BRANCH}`;
    const res = await fetch(url);

    if (!res.ok) {
        return null;
    }

    return await res.json();
}

async function buildTree(path = "", parent) {
    const items = await fetchDir(path);
    if (!items) return;

    for (const item of items) {
        if (item.type === "dir") {
            const dirEl = document.createElement("div");
            dirEl.textContent = item.name;
            dirEl.className = "dir";

            const subContainer = document.createElement("div");
            subContainer.className = "nested";

            dirEl.addEventListener("click", async () => {
                if (subContainer.childElementCount === 0) {
                    await buildTree(item.path, subContainer);
                }
                subContainer.style.display =
                    subContainer.style.display === "none" ? "block" : "none";
            });

            parent.appendChild(dirEl);
            parent.appendChild(subContainer);

        } else if (item.type === "file") {
            if (item.name == "index.html") {
            
            } else {
                const fileEl = document.createElement("div");
                fileEl.textContent = item.name;
                fileEl.className = "file";
                parent.appendChild(fileEl);
            }
        }
    }
}

(async () => {
    const root = document.getElementById("tree");
    await buildTree("", root);
})();
</script>

</body>
</html>
